<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Plotting Sociomatrices | Curley Lab Code Tutorials</title>
  <meta name="description" content="Chapter 3 Plotting Sociomatrices | Curley Lab Code Tutorials" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Plotting Sociomatrices | Curley Lab Code Tutorials" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Plotting Sociomatrices | Curley Lab Code Tutorials" />
  
  
  

<meta name="author" content="James Curley" />


<meta name="date" content="2021-09-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="analyzing-social-hierarchy-data.html"/>
<link rel="next" href="social-networks.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Code Tutorials</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="analyzing-social-hierarchy-data.html"><a href="analyzing-social-hierarchy-data.html"><i class="fa fa-check"></i><b>2</b> Analyzing Social Hierarchy Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="analyzing-social-hierarchy-data.html"><a href="analyzing-social-hierarchy-data.html#overview"><i class="fa fa-check"></i><b>2.1</b> Overview</a></li>
<li class="chapter" data-level="2.2" data-path="analyzing-social-hierarchy-data.html"><a href="analyzing-social-hierarchy-data.html#raw-data"><i class="fa fa-check"></i><b>2.2</b> Raw Data</a></li>
<li class="chapter" data-level="2.3" data-path="analyzing-social-hierarchy-data.html"><a href="analyzing-social-hierarchy-data.html#data-cleanup"><i class="fa fa-check"></i><b>2.3</b> Data Cleanup</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="analyzing-social-hierarchy-data.html"><a href="analyzing-social-hierarchy-data.html#time-formats"><i class="fa fa-check"></i><b>2.3.1</b> Time Formats</a></li>
<li class="chapter" data-level="2.3.2" data-path="analyzing-social-hierarchy-data.html"><a href="analyzing-social-hierarchy-data.html#actorrecipients"><i class="fa fa-check"></i><b>2.3.2</b> Actor/Recipients</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="analyzing-social-hierarchy-data.html"><a href="analyzing-social-hierarchy-data.html#data-analysis"><i class="fa fa-check"></i><b>2.4</b> Data Analysis</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="analyzing-social-hierarchy-data.html"><a href="analyzing-social-hierarchy-data.html#create-sociomatrices"><i class="fa fa-check"></i><b>2.4.1</b> Create Sociomatrices</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="analyzing-social-hierarchy-data.html"><a href="analyzing-social-hierarchy-data.html#basic-hierarchy-measures"><i class="fa fa-check"></i><b>2.5</b> Basic hierarchy Measures</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="analyzing-social-hierarchy-data.html"><a href="analyzing-social-hierarchy-data.html#descriptives"><i class="fa fa-check"></i><b>2.5.1</b> Descriptives</a></li>
<li class="chapter" data-level="2.5.2" data-path="analyzing-social-hierarchy-data.html"><a href="analyzing-social-hierarchy-data.html#directional-consistency"><i class="fa fa-check"></i><b>2.5.2</b> Directional Consistency</a></li>
<li class="chapter" data-level="2.5.3" data-path="analyzing-social-hierarchy-data.html"><a href="analyzing-social-hierarchy-data.html#de-vries-modified-h-value"><i class="fa fa-check"></i><b>2.5.3</b> De Vries’ Modified h’ value</a></li>
<li class="chapter" data-level="2.5.4" data-path="analyzing-social-hierarchy-data.html"><a href="analyzing-social-hierarchy-data.html#triangle-transitivity"><i class="fa fa-check"></i><b>2.5.4</b> Triangle Transitivity</a></li>
<li class="chapter" data-level="2.5.5" data-path="analyzing-social-hierarchy-data.html"><a href="analyzing-social-hierarchy-data.html#steepness"><i class="fa fa-check"></i><b>2.5.5</b> Steepness</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="analyzing-social-hierarchy-data.html"><a href="analyzing-social-hierarchy-data.html#individual-ranking-measures"><i class="fa fa-check"></i><b>2.6</b> Individual Ranking Measures</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="analyzing-social-hierarchy-data.html"><a href="analyzing-social-hierarchy-data.html#davids-scores"><i class="fa fa-check"></i><b>2.6.1</b> David’s Scores</a></li>
<li class="chapter" data-level="2.6.2" data-path="analyzing-social-hierarchy-data.html"><a href="analyzing-social-hierarchy-data.html#isi-method"><i class="fa fa-check"></i><b>2.6.2</b> I&amp;SI Method</a></li>
<li class="chapter" data-level="2.6.3" data-path="analyzing-social-hierarchy-data.html"><a href="analyzing-social-hierarchy-data.html#despotism"><i class="fa fa-check"></i><b>2.6.3</b> Despotism</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="analyzing-social-hierarchy-data.html"><a href="analyzing-social-hierarchy-data.html#plotting-sociomatrices"><i class="fa fa-check"></i><b>2.7</b> Plotting Sociomatrices</a></li>
<li class="chapter" data-level="2.8" data-path="analyzing-social-hierarchy-data.html"><a href="analyzing-social-hierarchy-data.html#network-certainty"><i class="fa fa-check"></i><b>2.8</b> Network Certainty</a></li>
<li class="chapter" data-level="2.9" data-path="analyzing-social-hierarchy-data.html"><a href="analyzing-social-hierarchy-data.html#temporal-based-methods"><i class="fa fa-check"></i><b>2.9</b> Temporal Based Methods</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="analyzing-social-hierarchy-data.html"><a href="analyzing-social-hierarchy-data.html#glicko-ratings"><i class="fa fa-check"></i><b>2.9.1</b> Glicko Ratings</a></li>
<li class="chapter" data-level="2.9.2" data-path="analyzing-social-hierarchy-data.html"><a href="analyzing-social-hierarchy-data.html#stability-indices"><i class="fa fa-check"></i><b>2.9.2</b> Stability Indices</a></li>
<li class="chapter" data-level="2.9.3" data-path="analyzing-social-hierarchy-data.html"><a href="analyzing-social-hierarchy-data.html#temporal-social-dynamics"><i class="fa fa-check"></i><b>2.9.3</b> Temporal Social Dynamics</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="analyzing-social-hierarchy-data.html"><a href="analyzing-social-hierarchy-data.html#summary"><i class="fa fa-check"></i><b>2.10</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="plotting-sociomatrices-1.html"><a href="plotting-sociomatrices-1.html"><i class="fa fa-check"></i><b>3</b> Plotting Sociomatrices</a>
<ul>
<li class="chapter" data-level="3.1" data-path="plotting-sociomatrices-1.html"><a href="plotting-sociomatrices-1.html#raw-sociomatrices"><i class="fa fa-check"></i><b>3.1</b> Raw Sociomatrices</a></li>
<li class="chapter" data-level="3.2" data-path="plotting-sociomatrices-1.html"><a href="plotting-sociomatrices-1.html#dichotomized-sociomatrices"><i class="fa fa-check"></i><b>3.2</b> Dichotomized Sociomatrices</a></li>
<li class="chapter" data-level="3.3" data-path="plotting-sociomatrices-1.html"><a href="plotting-sociomatrices-1.html#multiple-sociomatrices"><i class="fa fa-check"></i><b>3.3</b> Multiple Sociomatrices</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="social-networks.html"><a href="social-networks.html"><i class="fa fa-check"></i><b>4</b> Social Networks</a>
<ul>
<li class="chapter" data-level="4.1" data-path="social-networks.html"><a href="social-networks.html#permutation-methods"><i class="fa fa-check"></i><b>4.1</b> Permutation Methods</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="social-networks.html"><a href="social-networks.html#node-permutation-example"><i class="fa fa-check"></i><b>4.1.1</b> Node Permutation Example</a></li>
<li class="chapter" data-level="4.1.2" data-path="social-networks.html"><a href="social-networks.html#random-graph-approach"><i class="fa fa-check"></i><b>4.1.2</b> Random Graph Approach</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Curley Lab Code Tutorials</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="plotting-sociomatrices-1" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> Plotting Sociomatrices</h1>
<p>This chapter describes in detail how we make our sociomatrices using the <code>ggplot2</code> package.</p>
<p>We assume that you already have data in a sociomatrix. We will start with one such matrix - the <code>mouse</code> matrix that is available in the <a href="https://github.com/jalapic/compete"><code>compete</code></a> package.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="plotting-sociomatrices-1.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::install_github(&#39;jalapic/compete&#39;)</span></span>
<span id="cb86-2"><a href="plotting-sociomatrices-1.html#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(compete)</span>
<span id="cb86-3"><a href="plotting-sociomatrices-1.html#cb86-3" aria-hidden="true" tabindex="-1"></a>mouse</span></code></pre></div>
<pre><code>##   A B C D E  F G H I J  K L
## A 0 0 0 1 0  0 2 0 0 0  0 0
## B 1 0 1 1 0  0 0 0 1 0  0 0
## C 0 2 0 1 0  1 1 0 1 0  0 1
## D 0 0 1 0 0  1 1 0 0 0  0 1
## E 0 1 0 0 0  0 0 0 0 0  0 0
## F 0 0 2 2 0  0 2 0 0 0  3 1
## G 1 2 1 1 0  0 0 0 0 1  0 2
## H 4 7 4 4 5  6 2 0 5 7 14 5
## I 0 2 0 1 1  0 1 0 0 0  3 0
## J 5 8 6 2 7 15 3 4 1 0 25 6
## K 1 5 6 1 2  9 5 2 4 1  0 2
## L 0 1 0 0 0  2 0 2 0 0  1 0</code></pre>
<p>These data are actually stored in a data.frame of 12 rows and 12 columns:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="plotting-sociomatrices-1.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mouse)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    12 obs. of  12 variables:
##  $ A: int  0 1 0 0 0 0 1 4 0 5 ...
##  $ B: int  0 0 2 0 1 0 2 7 2 8 ...
##  $ C: int  0 1 0 1 0 2 1 4 0 6 ...
##  $ D: int  1 1 1 0 0 2 1 4 1 2 ...
##  $ E: int  0 0 0 0 0 0 0 5 1 7 ...
##  $ F: int  0 0 1 1 0 0 0 6 0 15 ...
##  $ G: int  2 0 1 1 0 2 0 2 1 3 ...
##  $ H: int  0 0 0 0 0 0 0 0 0 4 ...
##  $ I: int  0 1 1 0 0 0 0 5 0 1 ...
##  $ J: int  0 0 0 0 0 0 1 7 0 0 ...
##  $ K: int  0 0 0 0 0 3 0 14 3 25 ...
##  $ L: int  0 0 1 1 0 1 2 5 0 6 ...</code></pre>
<p><br></p>
<div id="raw-sociomatrices" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Raw Sociomatrices</h2>
<p>The first step we need to do is to convert the sociomatrix dataframe into long format data so we can give <code>x</code> and <code>y</code> coordinates. We can do this using the <code>melt</code> function from the <code>reshape2</code> package. We ensure that this output is a data.frame using <code>data.frame()</code>.</p>
<p>In case our diagonal had <code>NA</code> entries, we also only keep complete cases.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="plotting-sociomatrices-1.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">#make the df we will use for plotting</span></span>
<span id="cb90-2"><a href="plotting-sociomatrices-1.html#cb90-2" aria-hidden="true" tabindex="-1"></a>m.dat <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(mouse)</span>
<span id="cb90-3"><a href="plotting-sociomatrices-1.html#cb90-3" aria-hidden="true" tabindex="-1"></a>m.dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(m.dat)</span>
<span id="cb90-4"><a href="plotting-sociomatrices-1.html#cb90-4" aria-hidden="true" tabindex="-1"></a>m.dat <span class="ot">&lt;-</span> m.dat[<span class="fu">complete.cases</span>(m.dat),] <span class="co">#removing NAs</span></span>
<span id="cb90-5"><a href="plotting-sociomatrices-1.html#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(m.dat)</span></code></pre></div>
<pre><code>##   variable value
## 1        A     0
## 2        A     1
## 3        A     0
## 4        A     0
## 5        A     0
## 6        A     0</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="plotting-sociomatrices-1.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(m.dat)</span></code></pre></div>
<pre><code>##     variable value
## 139        L     2
## 140        L     5
## 141        L     0
## 142        L     6
## 143        L     2
## 144        L     0</code></pre>
<p><br></p>
<p>This just gives 2 columns of output. A <code>variable</code> column which refers to the original column that the <code>value</code> entry came from. We need to add a new column that gives the row location. These are in the order A-&gt;L.</p>
<p>We could just add that column like this:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="plotting-sociomatrices-1.html#cb94-1" aria-hidden="true" tabindex="-1"></a>m.dat<span class="sc">$</span>row.id <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>]</span>
<span id="cb94-2"><a href="plotting-sociomatrices-1.html#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(m.dat)</span></code></pre></div>
<pre><code>##   variable value row.id
## 1        A     0      A
## 2        A     1      B
## 3        A     0      C
## 4        A     0      D
## 5        A     0      E
## 6        A     0      F</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="plotting-sociomatrices-1.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(m.dat)</span></code></pre></div>
<pre><code>##     variable value row.id
## 139        L     2      G
## 140        L     5      H
## 141        L     0      I
## 142        L     6      J
## 143        L     2      K
## 144        L     0      L</code></pre>
<p><br></p>
<p>At this point, there are two main things that we should do before plotting. i) Decide whether to remove zeros - as sociomatrices generally look better without them in. ii) Reorder the ids by their dominance.</p>
<p>Let’s first make a very basic plot without doing either of these things.</p>
<p>We use <code>geom_tile()</code> from <code>ggplot2</code> to make our plot, and use <code>geom_text()</code> to add in the value. The <code>x</code> axis should be the loser (column from original sociomatrix) and the <code>y</code> axis should be the winner (row from the original sociomatrix).</p>
<p>The parameters inside <code>geom_tile()</code> define the color, fill and size of each tile.</p>
<p>The parameter <code>label=</code> inside <code>geom_text()</code> define which column supplies the text. We also dictate the color and size of the text.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="plotting-sociomatrices-1.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb98-2"><a href="plotting-sociomatrices-1.html#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="plotting-sociomatrices-1.html#cb98-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(m.dat, <span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>row.id)) <span class="sc">+</span></span>
<span id="cb98-4"><a href="plotting-sociomatrices-1.html#cb98-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">fill=</span><span class="st">&#39;white&#39;</span>) <span class="sc">+</span></span>
<span id="cb98-5"><a href="plotting-sociomatrices-1.html#cb98-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> value), <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fu">rel</span>(<span class="fl">3.5</span>)) <span class="sc">+</span></span>
<span id="cb98-6"><a href="plotting-sociomatrices-1.html#cb98-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb98-7"><a href="plotting-sociomatrices-1.html#cb98-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-8"><a href="plotting-sociomatrices-1.html#cb98-8" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-149-1.png" width="576" /></p>
<p><br></p>
<p>There are a number of other things that are wrong with this plot. First, it is more readable to have the labels on the x-axis at the top of the plot. We can do this as follows, while also labeling the axes with new titles:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="plotting-sociomatrices-1.html#cb99-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> </span>
<span id="cb99-2"><a href="plotting-sociomatrices-1.html#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">position =</span> <span class="st">&quot;top&quot;</span>) <span class="sc">+</span></span>
<span id="cb99-3"><a href="plotting-sociomatrices-1.html#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb99-4"><a href="plotting-sociomatrices-1.html#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Loser&quot;</span>) <span class="sc">+</span> </span>
<span id="cb99-5"><a href="plotting-sociomatrices-1.html#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Winner&quot;</span>)</span>
<span id="cb99-6"><a href="plotting-sociomatrices-1.html#cb99-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb99-7"><a href="plotting-sociomatrices-1.html#cb99-7" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-150-1.png" width="576" /></p>
<p><br></p>
<p>It still isn’t quite right. We can adjust a number of other <code>theme</code> elements to make the plot look better:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="plotting-sociomatrices-1.html#cb100-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> </span>
<span id="cb100-2"><a href="plotting-sociomatrices-1.html#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb100-3"><a href="plotting-sociomatrices-1.html#cb100-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb100-4"><a href="plotting-sociomatrices-1.html#cb100-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb100-5"><a href="plotting-sociomatrices-1.html#cb100-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb100-6"><a href="plotting-sociomatrices-1.html#cb100-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>,<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">linetype=</span><span class="st">&quot;solid&quot;</span>),</span>
<span id="cb100-7"><a href="plotting-sociomatrices-1.html#cb100-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb100-8"><a href="plotting-sociomatrices-1.html#cb100-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb100-9"><a href="plotting-sociomatrices-1.html#cb100-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb100-10"><a href="plotting-sociomatrices-1.html#cb100-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb100-11"><a href="plotting-sociomatrices-1.html#cb100-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;#3C3C3C&quot;</span>, <span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.1</span>)),</span>
<span id="cb100-12"><a href="plotting-sociomatrices-1.html#cb100-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>        </span>
<span id="cb100-13"><a href="plotting-sociomatrices-1.html#cb100-13" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb100-14"><a href="plotting-sociomatrices-1.html#cb100-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-15"><a href="plotting-sociomatrices-1.html#cb100-15" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-151-1.png" width="576" /></p>
<p><br></p>
<p>This looks better, but it still has three issues. The ids are in alphabetical order as opposed to being in dominance order. The matrix is full of zeros which make it harder to read. Finally, all tiles are filled with white, when it would be more readable to fill with a color that depicts the value of the cell/tile.</p>
<p>Let’s first remove the zeros. This should be done when we create the data.frame after melting. We substitute zeros with <code>NA</code>s.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="plotting-sociomatrices-1.html#cb101-1" aria-hidden="true" tabindex="-1"></a>m.dat[m.dat <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb101-2"><a href="plotting-sociomatrices-1.html#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(m.dat)</span></code></pre></div>
<pre><code>##   variable value row.id
## 1        A    NA      A
## 2        A     1      B
## 3        A    NA      C
## 4        A    NA      D
## 5        A    NA      E
## 6        A    NA      F</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="plotting-sociomatrices-1.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(m.dat)</span></code></pre></div>
<pre><code>##     variable value row.id
## 139        L     2      G
## 140        L     5      H
## 141        L    NA      I
## 142        L     6      J
## 143        L     2      K
## 144        L    NA      L</code></pre>
<p><br></p>
<p>We can now replot using the same plotting code as above:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="plotting-sociomatrices-1.html#cb105-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(m.dat, <span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>row.id)) <span class="sc">+</span></span>
<span id="cb105-2"><a href="plotting-sociomatrices-1.html#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">fill=</span><span class="st">&#39;white&#39;</span>) <span class="sc">+</span></span>
<span id="cb105-3"><a href="plotting-sociomatrices-1.html#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> value), <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fu">rel</span>(<span class="fl">3.5</span>)) <span class="sc">+</span></span>
<span id="cb105-4"><a href="plotting-sociomatrices-1.html#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb105-5"><a href="plotting-sociomatrices-1.html#cb105-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">position =</span> <span class="st">&quot;top&quot;</span>) <span class="sc">+</span></span>
<span id="cb105-6"><a href="plotting-sociomatrices-1.html#cb105-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb105-7"><a href="plotting-sociomatrices-1.html#cb105-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Loser&quot;</span>) <span class="sc">+</span> </span>
<span id="cb105-8"><a href="plotting-sociomatrices-1.html#cb105-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Winner&quot;</span>) <span class="sc">+</span> </span>
<span id="cb105-9"><a href="plotting-sociomatrices-1.html#cb105-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb105-10"><a href="plotting-sociomatrices-1.html#cb105-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb105-11"><a href="plotting-sociomatrices-1.html#cb105-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb105-12"><a href="plotting-sociomatrices-1.html#cb105-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb105-13"><a href="plotting-sociomatrices-1.html#cb105-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>,<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">linetype=</span><span class="st">&quot;solid&quot;</span>),</span>
<span id="cb105-14"><a href="plotting-sociomatrices-1.html#cb105-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb105-15"><a href="plotting-sociomatrices-1.html#cb105-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb105-16"><a href="plotting-sociomatrices-1.html#cb105-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb105-17"><a href="plotting-sociomatrices-1.html#cb105-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb105-18"><a href="plotting-sociomatrices-1.html#cb105-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;#3C3C3C&quot;</span>, <span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.1</span>)),</span>
<span id="cb105-19"><a href="plotting-sociomatrices-1.html#cb105-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>        </span>
<span id="cb105-20"><a href="plotting-sociomatrices-1.html#cb105-20" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb105-21"><a href="plotting-sociomatrices-1.html#cb105-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-22"><a href="plotting-sociomatrices-1.html#cb105-22" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-153-1.png" width="576" /></p>
<p><br></p>
<p>Reordering the order of individuals on the rows and columns requires a bit more thought. The best way to reorder would be based on some measure of dominance. For this example, we are going to choose to reorder the ids based on David’s Scores. We could pick other ranking methods though such as I&amp;SI.</p>
<p>To reorder by David’s Scores, we first must calculate the David’s Scores of each individual. We will use the <code>ds</code> function from the <code>compete</code> package:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="plotting-sociomatrices-1.html#cb106-1" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">ds</span>(mouse)</span>
<span id="cb106-2"><a href="plotting-sociomatrices-1.html#cb106-2" aria-hidden="true" tabindex="-1"></a>v</span></code></pre></div>
<pre><code>##            A            B            C            D            E            F 
##  -7.50702839 -20.20524267  -8.08154762 -16.11250000  -7.58202839  -4.25514347 
##            G            H            I            J            K            L 
##  -9.33750000  36.78053221  -0.06417125  34.27341270  13.91740735 -11.82619048</code></pre>
<p><br></p>
<p>We can reorder this vector and grab the names in descending order:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="plotting-sociomatrices-1.html#cb108-1" aria-hidden="true" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">names</span>(v)[<span class="fu">order</span>(v)])</span>
<span id="cb108-2"><a href="plotting-sociomatrices-1.html#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="plotting-sociomatrices-1.html#cb108-3" aria-hidden="true" tabindex="-1"></a>v1</span></code></pre></div>
<pre><code>##  [1] &quot;H&quot; &quot;J&quot; &quot;K&quot; &quot;I&quot; &quot;F&quot; &quot;A&quot; &quot;E&quot; &quot;C&quot; &quot;G&quot; &quot;L&quot; &quot;D&quot; &quot;B&quot;</code></pre>
<p><br></p>
<p>Now we have the order of individuals by their dominance. We can factorize our two columns containing the individual ids and set their levels. We actually have to make the levels of the winners the reverse order.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="plotting-sociomatrices-1.html#cb110-1" aria-hidden="true" tabindex="-1"></a>m.dat<span class="sc">$</span>variable <span class="ot">&lt;-</span> <span class="fu">factor</span>(m.dat<span class="sc">$</span>variable, <span class="at">levels=</span>v1)</span>
<span id="cb110-2"><a href="plotting-sociomatrices-1.html#cb110-2" aria-hidden="true" tabindex="-1"></a>m.dat<span class="sc">$</span>row.id <span class="ot">&lt;-</span> <span class="fu">factor</span>(m.dat<span class="sc">$</span>row.id, <span class="at">levels =</span> <span class="fu">rev</span>(v1))</span>
<span id="cb110-3"><a href="plotting-sociomatrices-1.html#cb110-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-4"><a href="plotting-sociomatrices-1.html#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(m.dat)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    144 obs. of  3 variables:
##  $ variable: Factor w/ 12 levels &quot;H&quot;,&quot;J&quot;,&quot;K&quot;,&quot;I&quot;,..: 6 6 6 6 6 6 6 6 6 6 ...
##  $ value   : int  NA 1 NA NA NA NA 1 4 NA 5 ...
##  $ row.id  : Factor w/ 12 levels &quot;B&quot;,&quot;D&quot;,&quot;L&quot;,&quot;G&quot;,..: 7 1 5 2 6 8 4 12 9 11 ...</code></pre>
<p><br></p>
<p>We can now replot the sociomatrix with the order of the ids now set:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="plotting-sociomatrices-1.html#cb112-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(m.dat, <span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>row.id)) <span class="sc">+</span></span>
<span id="cb112-2"><a href="plotting-sociomatrices-1.html#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">fill=</span><span class="st">&#39;white&#39;</span>) <span class="sc">+</span></span>
<span id="cb112-3"><a href="plotting-sociomatrices-1.html#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> value), <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fu">rel</span>(<span class="fl">3.5</span>)) <span class="sc">+</span></span>
<span id="cb112-4"><a href="plotting-sociomatrices-1.html#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb112-5"><a href="plotting-sociomatrices-1.html#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">position =</span> <span class="st">&quot;top&quot;</span>) <span class="sc">+</span></span>
<span id="cb112-6"><a href="plotting-sociomatrices-1.html#cb112-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb112-7"><a href="plotting-sociomatrices-1.html#cb112-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Loser&quot;</span>) <span class="sc">+</span> </span>
<span id="cb112-8"><a href="plotting-sociomatrices-1.html#cb112-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Winner&quot;</span>) <span class="sc">+</span> </span>
<span id="cb112-9"><a href="plotting-sociomatrices-1.html#cb112-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb112-10"><a href="plotting-sociomatrices-1.html#cb112-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb112-11"><a href="plotting-sociomatrices-1.html#cb112-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb112-12"><a href="plotting-sociomatrices-1.html#cb112-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb112-13"><a href="plotting-sociomatrices-1.html#cb112-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>,<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">linetype=</span><span class="st">&quot;solid&quot;</span>),</span>
<span id="cb112-14"><a href="plotting-sociomatrices-1.html#cb112-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb112-15"><a href="plotting-sociomatrices-1.html#cb112-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb112-16"><a href="plotting-sociomatrices-1.html#cb112-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb112-17"><a href="plotting-sociomatrices-1.html#cb112-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb112-18"><a href="plotting-sociomatrices-1.html#cb112-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;#3C3C3C&quot;</span>, <span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.1</span>)),</span>
<span id="cb112-19"><a href="plotting-sociomatrices-1.html#cb112-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>        </span>
<span id="cb112-20"><a href="plotting-sociomatrices-1.html#cb112-20" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb112-21"><a href="plotting-sociomatrices-1.html#cb112-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-22"><a href="plotting-sociomatrices-1.html#cb112-22" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-157-1.png" width="576" /></p>
<p><br></p>
<p>David’s Scores are a quick way of determining rank, but let’s instead go with the more formal I&amp;SI rankings. We can calculate these using the <code>isi98</code> function in the <code>compete</code> package:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="plotting-sociomatrices-1.html#cb113-1" aria-hidden="true" tabindex="-1"></a>isi <span class="ot">&lt;-</span> <span class="fu">isi98</span>(mouse)</span></code></pre></div>
<pre><code>## 
## INITIAL RANK: 
##  [1] &quot;H&quot; &quot;J&quot; &quot;K&quot; &quot;I&quot; &quot;F&quot; &quot;A&quot; &quot;E&quot; &quot;C&quot; &quot;G&quot; &quot;L&quot; &quot;D&quot; &quot;B&quot;
## I = 5
## SI = 17</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="plotting-sociomatrices-1.html#cb115-1" aria-hidden="true" tabindex="-1"></a>isi</span></code></pre></div>
<pre><code>## $best_matrix
##   H J  K  F C I E A G L B D
## H 0 7 14  6 4 5 5 4 2 5 7 4
## J 4 0 25 15 6 1 7 5 3 6 8 2
## K 2 1  0  9 6 4 2 1 5 2 5 1
## F 0 0  3  0 2 0 0 0 2 1 0 2
## C 0 0  0  1 0 1 0 0 1 1 2 1
## I 0 0  3  0 0 0 1 0 1 0 2 1
## E 0 0  0  0 0 0 0 0 0 0 1 0
## A 0 0  0  0 0 0 0 0 2 0 0 1
## G 0 1  0  0 1 0 0 1 0 2 2 1
## L 2 0  1  2 0 0 0 0 0 0 1 0
## B 0 0  0  0 1 1 0 1 0 0 0 1
## D 0 0  0  1 1 0 0 0 1 1 0 0
## 
## $best_order
##  [1] &quot;H&quot; &quot;J&quot; &quot;K&quot; &quot;F&quot; &quot;C&quot; &quot;I&quot; &quot;E&quot; &quot;A&quot; &quot;G&quot; &quot;L&quot; &quot;B&quot; &quot;D&quot;
## 
## $I
## [1] 3
## 
## $SI
## [1] 11
## 
## $rs
## [1] 0.9300699</code></pre>
<p><br>
We can graph the dominance rankings directly from the <code>$best_order</code> output.</p>
<p>It’s noticeable that this order differs quite a bit from the David’s Scores rankings:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="plotting-sociomatrices-1.html#cb117-1" aria-hidden="true" tabindex="-1"></a>isi<span class="sc">$</span>best_order</span></code></pre></div>
<pre><code>##  [1] &quot;H&quot; &quot;J&quot; &quot;K&quot; &quot;F&quot; &quot;C&quot; &quot;I&quot; &quot;E&quot; &quot;A&quot; &quot;G&quot; &quot;L&quot; &quot;B&quot; &quot;D&quot;</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="plotting-sociomatrices-1.html#cb119-1" aria-hidden="true" tabindex="-1"></a>v1</span></code></pre></div>
<pre><code>##  [1] &quot;H&quot; &quot;J&quot; &quot;K&quot; &quot;I&quot; &quot;F&quot; &quot;A&quot; &quot;E&quot; &quot;C&quot; &quot;G&quot; &quot;L&quot; &quot;D&quot; &quot;B&quot;</code></pre>
<p><br></p>
<p>We will then refactor our two columns based on these rankings.</p>
<p><br></p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="plotting-sociomatrices-1.html#cb121-1" aria-hidden="true" tabindex="-1"></a>m.dat<span class="sc">$</span>variable <span class="ot">&lt;-</span> <span class="fu">factor</span>(m.dat<span class="sc">$</span>variable, <span class="at">levels=</span>isi<span class="sc">$</span>best_order)</span>
<span id="cb121-2"><a href="plotting-sociomatrices-1.html#cb121-2" aria-hidden="true" tabindex="-1"></a>m.dat<span class="sc">$</span>row.id <span class="ot">&lt;-</span> <span class="fu">factor</span>(m.dat<span class="sc">$</span>row.id, <span class="at">levels =</span> <span class="fu">rev</span>(isi<span class="sc">$</span>best_order))</span>
<span id="cb121-3"><a href="plotting-sociomatrices-1.html#cb121-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-4"><a href="plotting-sociomatrices-1.html#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(m.dat)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    144 obs. of  3 variables:
##  $ variable: Factor w/ 12 levels &quot;H&quot;,&quot;J&quot;,&quot;K&quot;,&quot;F&quot;,..: 8 8 8 8 8 8 8 8 8 8 ...
##  $ value   : int  NA 1 NA NA NA NA 1 4 NA 5 ...
##  $ row.id  : Factor w/ 12 levels &quot;D&quot;,&quot;B&quot;,&quot;L&quot;,&quot;G&quot;,..: 5 2 8 1 6 9 4 12 7 11 ...</code></pre>
<p><br></p>
<p>And we can replot the matrix based on this order</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="plotting-sociomatrices-1.html#cb123-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(m.dat, <span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>row.id)) <span class="sc">+</span></span>
<span id="cb123-2"><a href="plotting-sociomatrices-1.html#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">fill=</span><span class="st">&#39;white&#39;</span>) <span class="sc">+</span></span>
<span id="cb123-3"><a href="plotting-sociomatrices-1.html#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> value), <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fu">rel</span>(<span class="fl">3.5</span>)) <span class="sc">+</span></span>
<span id="cb123-4"><a href="plotting-sociomatrices-1.html#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb123-5"><a href="plotting-sociomatrices-1.html#cb123-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">position =</span> <span class="st">&quot;top&quot;</span>) <span class="sc">+</span></span>
<span id="cb123-6"><a href="plotting-sociomatrices-1.html#cb123-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb123-7"><a href="plotting-sociomatrices-1.html#cb123-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Loser&quot;</span>) <span class="sc">+</span> </span>
<span id="cb123-8"><a href="plotting-sociomatrices-1.html#cb123-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Winner&quot;</span>) <span class="sc">+</span> </span>
<span id="cb123-9"><a href="plotting-sociomatrices-1.html#cb123-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb123-10"><a href="plotting-sociomatrices-1.html#cb123-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb123-11"><a href="plotting-sociomatrices-1.html#cb123-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb123-12"><a href="plotting-sociomatrices-1.html#cb123-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb123-13"><a href="plotting-sociomatrices-1.html#cb123-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>,<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">linetype=</span><span class="st">&quot;solid&quot;</span>),</span>
<span id="cb123-14"><a href="plotting-sociomatrices-1.html#cb123-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb123-15"><a href="plotting-sociomatrices-1.html#cb123-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb123-16"><a href="plotting-sociomatrices-1.html#cb123-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb123-17"><a href="plotting-sociomatrices-1.html#cb123-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb123-18"><a href="plotting-sociomatrices-1.html#cb123-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;#3C3C3C&quot;</span>, <span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.1</span>)),</span>
<span id="cb123-19"><a href="plotting-sociomatrices-1.html#cb123-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>        </span>
<span id="cb123-20"><a href="plotting-sociomatrices-1.html#cb123-20" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb123-21"><a href="plotting-sociomatrices-1.html#cb123-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-22"><a href="plotting-sociomatrices-1.html#cb123-22" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-161-1.png" width="576" /></p>
<p><br></p>
<p>This now is starting to look like a proper sociomatrix. There are however quite a few numbers under the diagonal. It’s not immediately obvious which numbers are inconsistencies - i.e. when the individual in the row is a winner over the individual in the column. For instance, L beats F 2 times, whereas F beats L 1 time only. Therefore this is an inconsistent relationship. However, L beats H 2 times, but H beats L 5 times, so this is not inconsistent.
One way we could fill these tiles would just be based on the value of the cell. This can be done using <code>scale_fill_gradient()</code>. To this we need to supply a fill color for the lowest value (which is actually 1 not 0 as we removed them) and a fill color for the highest value. We also need to add <code>fill=value</code> inside the <code>ggplot()</code> function - we also remove <code>fill="white"</code> from the <code>geom_tile()</code> function.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="plotting-sociomatrices-1.html#cb124-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(m.dat, <span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>row.id, <span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb124-2"><a href="plotting-sociomatrices-1.html#cb124-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb124-3"><a href="plotting-sociomatrices-1.html#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> value), <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fu">rel</span>(<span class="fl">3.5</span>)) <span class="sc">+</span></span>
<span id="cb124-4"><a href="plotting-sociomatrices-1.html#cb124-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb124-5"><a href="plotting-sociomatrices-1.html#cb124-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">position =</span> <span class="st">&quot;top&quot;</span>) <span class="sc">+</span></span>
<span id="cb124-6"><a href="plotting-sociomatrices-1.html#cb124-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb124-7"><a href="plotting-sociomatrices-1.html#cb124-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Loser&quot;</span>) <span class="sc">+</span> </span>
<span id="cb124-8"><a href="plotting-sociomatrices-1.html#cb124-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Winner&quot;</span>) <span class="sc">+</span> </span>
<span id="cb124-9"><a href="plotting-sociomatrices-1.html#cb124-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb124-10"><a href="plotting-sociomatrices-1.html#cb124-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb124-11"><a href="plotting-sociomatrices-1.html#cb124-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb124-12"><a href="plotting-sociomatrices-1.html#cb124-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb124-13"><a href="plotting-sociomatrices-1.html#cb124-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>,<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">linetype=</span><span class="st">&quot;solid&quot;</span>),</span>
<span id="cb124-14"><a href="plotting-sociomatrices-1.html#cb124-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb124-15"><a href="plotting-sociomatrices-1.html#cb124-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb124-16"><a href="plotting-sociomatrices-1.html#cb124-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb124-17"><a href="plotting-sociomatrices-1.html#cb124-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb124-18"><a href="plotting-sociomatrices-1.html#cb124-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;#3C3C3C&quot;</span>, <span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.1</span>)),</span>
<span id="cb124-19"><a href="plotting-sociomatrices-1.html#cb124-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>        </span>
<span id="cb124-20"><a href="plotting-sociomatrices-1.html#cb124-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb124-21"><a href="plotting-sociomatrices-1.html#cb124-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(</span>
<span id="cb124-22"><a href="plotting-sociomatrices-1.html#cb124-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">low =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb124-23"><a href="plotting-sociomatrices-1.html#cb124-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">high =</span> <span class="st">&quot;red1&quot;</span>, </span>
<span id="cb124-24"><a href="plotting-sociomatrices-1.html#cb124-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">space =</span> <span class="st">&quot;Lab&quot;</span>, </span>
<span id="cb124-25"><a href="plotting-sociomatrices-1.html#cb124-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb124-26"><a href="plotting-sociomatrices-1.html#cb124-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">guide =</span> <span class="st">&quot;colourbar&quot;</span>)</span>
<span id="cb124-27"><a href="plotting-sociomatrices-1.html#cb124-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-28"><a href="plotting-sociomatrices-1.html#cb124-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-29"><a href="plotting-sociomatrices-1.html#cb124-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-30"><a href="plotting-sociomatrices-1.html#cb124-30" aria-hidden="true" tabindex="-1"></a>p </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-162-1.png" width="576" /></p>
<p><br></p>
<p>This looks ok, but the shading is heavily skewed by the highest value. One alternatively strategy would be to log the value column, and supply that information as the new fill value. To do this, we would add a new column to the data.frame.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="plotting-sociomatrices-1.html#cb125-1" aria-hidden="true" tabindex="-1"></a>m.dat<span class="sc">$</span>value_log <span class="ot">&lt;-</span> <span class="fu">log</span>(m.dat<span class="sc">$</span>value)</span>
<span id="cb125-2"><a href="plotting-sociomatrices-1.html#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="plotting-sociomatrices-1.html#cb125-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(m.dat, <span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>row.id, <span class="at">fill=</span>value_log)) <span class="sc">+</span></span>
<span id="cb125-4"><a href="plotting-sociomatrices-1.html#cb125-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb125-5"><a href="plotting-sociomatrices-1.html#cb125-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> value), <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fu">rel</span>(<span class="fl">3.5</span>)) <span class="sc">+</span></span>
<span id="cb125-6"><a href="plotting-sociomatrices-1.html#cb125-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb125-7"><a href="plotting-sociomatrices-1.html#cb125-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">position =</span> <span class="st">&quot;top&quot;</span>) <span class="sc">+</span></span>
<span id="cb125-8"><a href="plotting-sociomatrices-1.html#cb125-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb125-9"><a href="plotting-sociomatrices-1.html#cb125-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Loser&quot;</span>) <span class="sc">+</span> </span>
<span id="cb125-10"><a href="plotting-sociomatrices-1.html#cb125-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Winner&quot;</span>) <span class="sc">+</span> </span>
<span id="cb125-11"><a href="plotting-sociomatrices-1.html#cb125-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb125-12"><a href="plotting-sociomatrices-1.html#cb125-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb125-13"><a href="plotting-sociomatrices-1.html#cb125-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb125-14"><a href="plotting-sociomatrices-1.html#cb125-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb125-15"><a href="plotting-sociomatrices-1.html#cb125-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>,<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">linetype=</span><span class="st">&quot;solid&quot;</span>),</span>
<span id="cb125-16"><a href="plotting-sociomatrices-1.html#cb125-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb125-17"><a href="plotting-sociomatrices-1.html#cb125-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb125-18"><a href="plotting-sociomatrices-1.html#cb125-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb125-19"><a href="plotting-sociomatrices-1.html#cb125-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb125-20"><a href="plotting-sociomatrices-1.html#cb125-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;#3C3C3C&quot;</span>, <span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.1</span>)),</span>
<span id="cb125-21"><a href="plotting-sociomatrices-1.html#cb125-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>        </span>
<span id="cb125-22"><a href="plotting-sociomatrices-1.html#cb125-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb125-23"><a href="plotting-sociomatrices-1.html#cb125-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(</span>
<span id="cb125-24"><a href="plotting-sociomatrices-1.html#cb125-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">low =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb125-25"><a href="plotting-sociomatrices-1.html#cb125-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">high =</span> <span class="st">&quot;red1&quot;</span>, </span>
<span id="cb125-26"><a href="plotting-sociomatrices-1.html#cb125-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">space =</span> <span class="st">&quot;Lab&quot;</span>, </span>
<span id="cb125-27"><a href="plotting-sociomatrices-1.html#cb125-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb125-28"><a href="plotting-sociomatrices-1.html#cb125-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">guide =</span> <span class="st">&quot;colourbar&quot;</span>)</span>
<span id="cb125-29"><a href="plotting-sociomatrices-1.html#cb125-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-30"><a href="plotting-sociomatrices-1.html#cb125-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb125-31"><a href="plotting-sociomatrices-1.html#cb125-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb125-32"><a href="plotting-sociomatrices-1.html#cb125-32" aria-hidden="true" tabindex="-1"></a>p </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-163-1.png" width="576" /></p>
<p><br></p>
<p>This looks a bit better.</p>
<p>Another way to represent the relationships is by filling the tile with a shade of color that represents the directional consistency of each relationship.</p>
<p>We can do that by adding a new column to the data.frame which represents the directional consistency of each measure. We can calculate this directly from the original matrix.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="plotting-sociomatrices-1.html#cb126-1" aria-hidden="true" tabindex="-1"></a>dcs <span class="ot">&lt;-</span> mouse <span class="sc">/</span> (mouse <span class="sc">+</span> <span class="fu">t</span>(mouse))</span>
<span id="cb126-2"><a href="plotting-sociomatrices-1.html#cb126-2" aria-hidden="true" tabindex="-1"></a>m.dat<span class="sc">$</span>DC <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(dcs)[,<span class="dv">2</span>]</span>
<span id="cb126-3"><a href="plotting-sociomatrices-1.html#cb126-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-4"><a href="plotting-sociomatrices-1.html#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(m.dat)</span></code></pre></div>
<pre><code>##   variable value row.id value_log  DC
## 1        A    NA      A        NA NaN
## 2        A     1      B         0   1
## 3        A    NA      C        NA NaN
## 4        A    NA      D        NA   0
## 5        A    NA      E        NA NaN
## 6        A    NA      F        NA NaN</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="plotting-sociomatrices-1.html#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(m.dat)</span></code></pre></div>
<pre><code>##     variable value row.id value_log        DC
## 139        L     2      G 0.6931472 1.0000000
## 140        L     5      H 1.6094379 0.7142857
## 141        L    NA      I        NA       NaN
## 142        L     6      J 1.7917595 1.0000000
## 143        L     2      K 0.6931472 0.6666667
## 144        L    NA      L        NA       NaN</code></pre>
<p><br></p>
<p>Now we can plot based on this measure:</p>
<p><br></p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="plotting-sociomatrices-1.html#cb130-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(m.dat, <span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>row.id, <span class="at">fill=</span>DC)) <span class="sc">+</span></span>
<span id="cb130-2"><a href="plotting-sociomatrices-1.html#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb130-3"><a href="plotting-sociomatrices-1.html#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> value), <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fu">rel</span>(<span class="fl">3.5</span>)) <span class="sc">+</span></span>
<span id="cb130-4"><a href="plotting-sociomatrices-1.html#cb130-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb130-5"><a href="plotting-sociomatrices-1.html#cb130-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">position =</span> <span class="st">&quot;top&quot;</span>) <span class="sc">+</span></span>
<span id="cb130-6"><a href="plotting-sociomatrices-1.html#cb130-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb130-7"><a href="plotting-sociomatrices-1.html#cb130-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Loser&quot;</span>) <span class="sc">+</span> </span>
<span id="cb130-8"><a href="plotting-sociomatrices-1.html#cb130-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Winner&quot;</span>) <span class="sc">+</span> </span>
<span id="cb130-9"><a href="plotting-sociomatrices-1.html#cb130-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb130-10"><a href="plotting-sociomatrices-1.html#cb130-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb130-11"><a href="plotting-sociomatrices-1.html#cb130-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb130-12"><a href="plotting-sociomatrices-1.html#cb130-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb130-13"><a href="plotting-sociomatrices-1.html#cb130-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>,<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">linetype=</span><span class="st">&quot;solid&quot;</span>),</span>
<span id="cb130-14"><a href="plotting-sociomatrices-1.html#cb130-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb130-15"><a href="plotting-sociomatrices-1.html#cb130-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb130-16"><a href="plotting-sociomatrices-1.html#cb130-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb130-17"><a href="plotting-sociomatrices-1.html#cb130-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb130-18"><a href="plotting-sociomatrices-1.html#cb130-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;#3C3C3C&quot;</span>, <span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.1</span>)),</span>
<span id="cb130-19"><a href="plotting-sociomatrices-1.html#cb130-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>        </span>
<span id="cb130-20"><a href="plotting-sociomatrices-1.html#cb130-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb130-21"><a href="plotting-sociomatrices-1.html#cb130-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(</span>
<span id="cb130-22"><a href="plotting-sociomatrices-1.html#cb130-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">low =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb130-23"><a href="plotting-sociomatrices-1.html#cb130-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">high =</span> <span class="st">&quot;red1&quot;</span>, </span>
<span id="cb130-24"><a href="plotting-sociomatrices-1.html#cb130-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">space =</span> <span class="st">&quot;Lab&quot;</span>, </span>
<span id="cb130-25"><a href="plotting-sociomatrices-1.html#cb130-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb130-26"><a href="plotting-sociomatrices-1.html#cb130-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">guide =</span> <span class="st">&quot;colourbar&quot;</span>)</span>
<span id="cb130-27"><a href="plotting-sociomatrices-1.html#cb130-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-28"><a href="plotting-sociomatrices-1.html#cb130-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-29"><a href="plotting-sociomatrices-1.html#cb130-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-30"><a href="plotting-sociomatrices-1.html#cb130-30" aria-hidden="true" tabindex="-1"></a>p </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-165-1.png" width="576" /></p>
<p><br></p>
<p>Except this looks confusing. It would be better only to color the tiles when the animal is dominant and exclude those who are not.</p>
<p>We can check for each pair of individuals which has the highest directional consistency by checking the matrix of directional consistencies against its transpose. We then assign a <code>NA</code> to any cell that is not greater than its transpose:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="plotting-sociomatrices-1.html#cb131-1" aria-hidden="true" tabindex="-1"></a>dcs[dcs<span class="sc">&lt;=</span><span class="fu">t</span>(dcs)]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb131-2"><a href="plotting-sociomatrices-1.html#cb131-2" aria-hidden="true" tabindex="-1"></a>dcs</span></code></pre></div>
<pre><code>##     A         B         C         D   E         F         G   H         I
## A NaN        NA       NaN 1.0000000 NaN       NaN 0.6666667  NA       NaN
## B   1       NaN        NA 1.0000000  NA       NaN        NA  NA        NA
## C NaN 0.6666667       NaN        NA NaN        NA        NA  NA 1.0000000
## D  NA        NA        NA       NaN NaN        NA        NA  NA        NA
## E NaN 1.0000000       NaN       NaN NaN       NaN       NaN  NA        NA
## F NaN       NaN 0.6666667 0.6666667 NaN       NaN 1.0000000  NA       NaN
## G  NA 1.0000000        NA        NA NaN        NA       NaN  NA        NA
## H   1 1.0000000 1.0000000 1.0000000   1 1.0000000 1.0000000 NaN 1.0000000
## I NaN 0.6666667        NA 1.0000000   1       NaN 1.0000000  NA       NaN
## J   1 1.0000000 1.0000000 1.0000000   1 1.0000000 0.7500000  NA 1.0000000
## K   1 1.0000000 1.0000000 1.0000000   1 0.7500000 1.0000000  NA 0.5714286
## L NaN 1.0000000        NA        NA NaN 0.6666667        NA  NA       NaN
##           J         K         L
## A        NA        NA       NaN
## B        NA        NA        NA
## C        NA        NA 1.0000000
## D        NA        NA 1.0000000
## E        NA        NA       NaN
## F        NA        NA        NA
## G        NA        NA 1.0000000
## H 0.6363636 0.8750000 0.7142857
## I        NA        NA       NaN
## J       NaN 0.9615385 1.0000000
## K        NA       NaN 0.6666667
## L        NA        NA       NaN</code></pre>
<p><br></p>
<p>We now can <code>melt</code> this matrix to provide the new fill values of directional consistency and use those for plotting:</p>
<p><br></p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="plotting-sociomatrices-1.html#cb133-1" aria-hidden="true" tabindex="-1"></a>m.dat<span class="sc">$</span>DC1 <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(dcs)[,<span class="dv">2</span>] <span class="co"># only need 2nd column of melt output</span></span>
<span id="cb133-2"><a href="plotting-sociomatrices-1.html#cb133-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-3"><a href="plotting-sociomatrices-1.html#cb133-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(m.dat, <span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>row.id, <span class="at">fill=</span>DC1)) <span class="sc">+</span></span>
<span id="cb133-4"><a href="plotting-sociomatrices-1.html#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb133-5"><a href="plotting-sociomatrices-1.html#cb133-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> value), <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fu">rel</span>(<span class="fl">3.5</span>)) <span class="sc">+</span></span>
<span id="cb133-6"><a href="plotting-sociomatrices-1.html#cb133-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb133-7"><a href="plotting-sociomatrices-1.html#cb133-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">position =</span> <span class="st">&quot;top&quot;</span>) <span class="sc">+</span></span>
<span id="cb133-8"><a href="plotting-sociomatrices-1.html#cb133-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb133-9"><a href="plotting-sociomatrices-1.html#cb133-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Loser&quot;</span>) <span class="sc">+</span> </span>
<span id="cb133-10"><a href="plotting-sociomatrices-1.html#cb133-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Winner&quot;</span>) <span class="sc">+</span> </span>
<span id="cb133-11"><a href="plotting-sociomatrices-1.html#cb133-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb133-12"><a href="plotting-sociomatrices-1.html#cb133-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb133-13"><a href="plotting-sociomatrices-1.html#cb133-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb133-14"><a href="plotting-sociomatrices-1.html#cb133-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb133-15"><a href="plotting-sociomatrices-1.html#cb133-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>,<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">linetype=</span><span class="st">&quot;solid&quot;</span>),</span>
<span id="cb133-16"><a href="plotting-sociomatrices-1.html#cb133-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb133-17"><a href="plotting-sociomatrices-1.html#cb133-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb133-18"><a href="plotting-sociomatrices-1.html#cb133-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb133-19"><a href="plotting-sociomatrices-1.html#cb133-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb133-20"><a href="plotting-sociomatrices-1.html#cb133-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;#3C3C3C&quot;</span>, <span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.1</span>)),</span>
<span id="cb133-21"><a href="plotting-sociomatrices-1.html#cb133-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>        </span>
<span id="cb133-22"><a href="plotting-sociomatrices-1.html#cb133-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb133-23"><a href="plotting-sociomatrices-1.html#cb133-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(</span>
<span id="cb133-24"><a href="plotting-sociomatrices-1.html#cb133-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">low =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb133-25"><a href="plotting-sociomatrices-1.html#cb133-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">high =</span> <span class="st">&quot;red1&quot;</span>, </span>
<span id="cb133-26"><a href="plotting-sociomatrices-1.html#cb133-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">space =</span> <span class="st">&quot;Lab&quot;</span>, </span>
<span id="cb133-27"><a href="plotting-sociomatrices-1.html#cb133-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb133-28"><a href="plotting-sociomatrices-1.html#cb133-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">guide =</span> <span class="st">&quot;colourbar&quot;</span>)</span>
<span id="cb133-29"><a href="plotting-sociomatrices-1.html#cb133-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-30"><a href="plotting-sociomatrices-1.html#cb133-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb133-31"><a href="plotting-sociomatrices-1.html#cb133-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb133-32"><a href="plotting-sociomatrices-1.html#cb133-32" aria-hidden="true" tabindex="-1"></a>p </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-167-1.png" width="576" /></p>
<p><br></p>
<p>But wait, there is actually however one mistake with this plot. Remeber that <code>scale_fill_manual()</code> fills the colors of the plot from lowest to highest, making the lowest equal to “white”. As we plotted the above plot based on <code>DC1</code>column which was only keeping the highest directional consistency value for each relationship, that means one of these “high” DC values is still the “lowest” in that column. We can find it:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="plotting-sociomatrices-1.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(m.dat<span class="sc">$</span>DC1,<span class="at">na.rm=</span>T)</span></code></pre></div>
<pre><code>## [1] 0.5714286</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="plotting-sociomatrices-1.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(m.dat<span class="sc">$</span>DC1 <span class="sc">==</span> <span class="fu">min</span>(m.dat<span class="sc">$</span>DC1,<span class="at">na.rm=</span>T))</span></code></pre></div>
<pre><code>## [1] 107</code></pre>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="plotting-sociomatrices-1.html#cb138-1" aria-hidden="true" tabindex="-1"></a>m.dat[<span class="dv">107</span>,] <span class="co"># I vs K</span></span></code></pre></div>
<pre><code>##     variable value row.id value_log        DC       DC1
## 107        I     4      K  1.386294 0.5714286 0.5714286</code></pre>
<p>It turns out that K beat I 4 times, and I beat K 3 times - giving K a directional consistency of 0.57 over I. When looking at the above plot, you will notice that the tile in the row of K and column of I which has a 4 in it is white. Technically, this should be a very pale red color.</p>
<p>How do we fix this ?</p>
<p>Essentially we need to put some DC values back into this column. But we need to choose wisely. Should we pick a value of 0? This then might skew the range of colors, although DC does vary between 0 and 1. Alternatively, we could pick 0.5 as we are only interested in looking at the higher DC values.</p>
<p>In this example, I’ll pick 0.5 as the cutoff value. What we should do is replace and <code>NA</code> values in the <code>DC1</code> column with 0.5</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="plotting-sociomatrices-1.html#cb140-1" aria-hidden="true" tabindex="-1"></a>m.dat<span class="sc">$</span>DC1 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(m.dat<span class="sc">$</span>DC1), <span class="fl">0.5</span>, m.dat<span class="sc">$</span>DC1)</span>
<span id="cb140-2"><a href="plotting-sociomatrices-1.html#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(m.dat)</span></code></pre></div>
<pre><code>##     variable value row.id value_log        DC       DC1
## 139        L     2      G 0.6931472 1.0000000 1.0000000
## 140        L     5      H 1.6094379 0.7142857 0.7142857
## 141        L    NA      I        NA       NaN 0.5000000
## 142        L     6      J 1.7917595 1.0000000 1.0000000
## 143        L     2      K 0.6931472 0.6666667 0.6666667
## 144        L    NA      L        NA       NaN 0.5000000</code></pre>
<p>Now, let’s replot:</p>
<p><br></p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="plotting-sociomatrices-1.html#cb142-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(m.dat, <span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>row.id, <span class="at">fill=</span>DC1)) <span class="sc">+</span></span>
<span id="cb142-2"><a href="plotting-sociomatrices-1.html#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb142-3"><a href="plotting-sociomatrices-1.html#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> value), <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fu">rel</span>(<span class="fl">3.5</span>)) <span class="sc">+</span></span>
<span id="cb142-4"><a href="plotting-sociomatrices-1.html#cb142-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb142-5"><a href="plotting-sociomatrices-1.html#cb142-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">position =</span> <span class="st">&quot;top&quot;</span>) <span class="sc">+</span></span>
<span id="cb142-6"><a href="plotting-sociomatrices-1.html#cb142-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb142-7"><a href="plotting-sociomatrices-1.html#cb142-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Loser&quot;</span>) <span class="sc">+</span> </span>
<span id="cb142-8"><a href="plotting-sociomatrices-1.html#cb142-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Winner&quot;</span>) <span class="sc">+</span> </span>
<span id="cb142-9"><a href="plotting-sociomatrices-1.html#cb142-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb142-10"><a href="plotting-sociomatrices-1.html#cb142-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb142-11"><a href="plotting-sociomatrices-1.html#cb142-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb142-12"><a href="plotting-sociomatrices-1.html#cb142-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb142-13"><a href="plotting-sociomatrices-1.html#cb142-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>,<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">linetype=</span><span class="st">&quot;solid&quot;</span>),</span>
<span id="cb142-14"><a href="plotting-sociomatrices-1.html#cb142-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb142-15"><a href="plotting-sociomatrices-1.html#cb142-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb142-16"><a href="plotting-sociomatrices-1.html#cb142-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb142-17"><a href="plotting-sociomatrices-1.html#cb142-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb142-18"><a href="plotting-sociomatrices-1.html#cb142-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;#3C3C3C&quot;</span>, <span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.1</span>)),</span>
<span id="cb142-19"><a href="plotting-sociomatrices-1.html#cb142-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>        </span>
<span id="cb142-20"><a href="plotting-sociomatrices-1.html#cb142-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb142-21"><a href="plotting-sociomatrices-1.html#cb142-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(</span>
<span id="cb142-22"><a href="plotting-sociomatrices-1.html#cb142-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">low =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb142-23"><a href="plotting-sociomatrices-1.html#cb142-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">high =</span> <span class="st">&quot;red1&quot;</span>, </span>
<span id="cb142-24"><a href="plotting-sociomatrices-1.html#cb142-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">space =</span> <span class="st">&quot;Lab&quot;</span>, </span>
<span id="cb142-25"><a href="plotting-sociomatrices-1.html#cb142-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb142-26"><a href="plotting-sociomatrices-1.html#cb142-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">guide =</span> <span class="st">&quot;colourbar&quot;</span>)</span>
<span id="cb142-27"><a href="plotting-sociomatrices-1.html#cb142-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-28"><a href="plotting-sociomatrices-1.html#cb142-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb142-29"><a href="plotting-sociomatrices-1.html#cb142-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb142-30"><a href="plotting-sociomatrices-1.html#cb142-30" aria-hidden="true" tabindex="-1"></a>p </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-170-1.png" width="576" /></p>
<p><br></p>
<p>Notice that now the tile K-I with a 4 in it is now filled with color, but all the others that should be white are still white.</p>
<p><br></p>
</div>
<div id="dichotomized-sociomatrices" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Dichotomized Sociomatrices</h2>
<p>We can plot dichotomized sociomatrices in two ways. The first would be to use the function <code>get_di_matrix()</code> from the <code>compete</code> package to generate a dichotomized matrix. We would then go through similar steps as above.</p>
<p>This is the dichotomized matrix:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="plotting-sociomatrices-1.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_di_matrix</span>(mouse)</span></code></pre></div>
<pre><code>##   A B C D E F G H I J K L
## A 0 0 0 1 0 0 1 0 0 0 0 0
## B 1 0 0 1 0 0 0 0 0 0 0 0
## C 0 1 0 0 0 0 0 0 1 0 0 1
## D 0 0 0 0 0 0 0 0 0 0 0 1
## E 0 1 0 0 0 0 0 0 0 0 0 0
## F 0 0 1 1 0 0 1 0 0 0 0 0
## G 0 1 0 0 0 0 0 0 0 0 0 1
## H 1 1 1 1 1 1 1 0 1 1 1 1
## I 0 1 0 1 1 0 1 0 0 0 0 0
## J 1 1 1 1 1 1 1 0 1 0 1 1
## K 1 1 1 1 1 1 1 0 1 0 0 1
## L 0 1 0 0 0 1 0 0 0 0 0 0</code></pre>
<p><br></p>
<p>Alternatively, if we have already gone through the above steps, we can simply piggy-back on the plot we just made based on the directional consistency. In this plot, the only tiles that receive a color are those with a directional consistency above 0.5, which is exactly what we want for a dichotomized matrix. All we need to do is replace the text values. We no longer want the raw values, but a 1 if their directional consistency is above 0.5.</p>
<p>All we need to do is create a new value column and populate with 1s when the DC &gt; 0.5 using an <code>ifelse()</code> statement:</p>
<p><br></p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="plotting-sociomatrices-1.html#cb145-1" aria-hidden="true" tabindex="-1"></a>m.dat<span class="sc">$</span>value1 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(m.dat<span class="sc">$</span>DC1<span class="sc">&gt;</span>.<span class="dv">5</span>, <span class="dv">1</span>, <span class="cn">NA</span>)</span></code></pre></div>
<p><br></p>
<p>We can then replot putting in this new text:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="plotting-sociomatrices-1.html#cb146-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(m.dat, <span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>row.id, <span class="at">fill=</span>DC1)) <span class="sc">+</span></span>
<span id="cb146-2"><a href="plotting-sociomatrices-1.html#cb146-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb146-3"><a href="plotting-sociomatrices-1.html#cb146-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> value1), <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fu">rel</span>(<span class="fl">3.5</span>)) <span class="sc">+</span></span>
<span id="cb146-4"><a href="plotting-sociomatrices-1.html#cb146-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb146-5"><a href="plotting-sociomatrices-1.html#cb146-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">position =</span> <span class="st">&quot;top&quot;</span>) <span class="sc">+</span></span>
<span id="cb146-6"><a href="plotting-sociomatrices-1.html#cb146-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb146-7"><a href="plotting-sociomatrices-1.html#cb146-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Loser&quot;</span>) <span class="sc">+</span> </span>
<span id="cb146-8"><a href="plotting-sociomatrices-1.html#cb146-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Winner&quot;</span>) <span class="sc">+</span> </span>
<span id="cb146-9"><a href="plotting-sociomatrices-1.html#cb146-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb146-10"><a href="plotting-sociomatrices-1.html#cb146-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb146-11"><a href="plotting-sociomatrices-1.html#cb146-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb146-12"><a href="plotting-sociomatrices-1.html#cb146-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb146-13"><a href="plotting-sociomatrices-1.html#cb146-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>,<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">linetype=</span><span class="st">&quot;solid&quot;</span>),</span>
<span id="cb146-14"><a href="plotting-sociomatrices-1.html#cb146-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb146-15"><a href="plotting-sociomatrices-1.html#cb146-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb146-16"><a href="plotting-sociomatrices-1.html#cb146-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb146-17"><a href="plotting-sociomatrices-1.html#cb146-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb146-18"><a href="plotting-sociomatrices-1.html#cb146-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;#3C3C3C&quot;</span>, <span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.1</span>)),</span>
<span id="cb146-19"><a href="plotting-sociomatrices-1.html#cb146-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>        </span>
<span id="cb146-20"><a href="plotting-sociomatrices-1.html#cb146-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb146-21"><a href="plotting-sociomatrices-1.html#cb146-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(</span>
<span id="cb146-22"><a href="plotting-sociomatrices-1.html#cb146-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">low =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb146-23"><a href="plotting-sociomatrices-1.html#cb146-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">high =</span> <span class="st">&quot;red1&quot;</span>, </span>
<span id="cb146-24"><a href="plotting-sociomatrices-1.html#cb146-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">space =</span> <span class="st">&quot;Lab&quot;</span>, </span>
<span id="cb146-25"><a href="plotting-sociomatrices-1.html#cb146-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb146-26"><a href="plotting-sociomatrices-1.html#cb146-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">guide =</span> <span class="st">&quot;colourbar&quot;</span>)</span>
<span id="cb146-27"><a href="plotting-sociomatrices-1.html#cb146-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-28"><a href="plotting-sociomatrices-1.html#cb146-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb146-29"><a href="plotting-sociomatrices-1.html#cb146-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb146-30"><a href="plotting-sociomatrices-1.html#cb146-30" aria-hidden="true" tabindex="-1"></a>p </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-173-1.png" width="576" /></p>
<p><br></p>
</div>
<div id="multiple-sociomatrices" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Multiple Sociomatrices</h2>
<p>If we want to plot multiple sociomatrices we need to consider how to color the tiles.</p>
<p>As an example here are some data that have three groups of four mice:</p>
<p><br></p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="plotting-sociomatrices-1.html#cb147-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://gist.githubusercontent.com/jalapic/98d09d5c98e28276e81d3bc3de3e3832/raw/2175e26485d5b9790c7ef48bf14f94a96e16a4b9/threegroups.csv&quot;</span>)</span>
<span id="cb147-2"><a href="plotting-sociomatrices-1.html#cb147-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-3"><a href="plotting-sociomatrices-1.html#cb147-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   Group id1   id2   value
##   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;
## 1     1 A     A         0
## 2     1 A     B        15
## 3     1 A     C        11
## 4     1 A     D         8
## 5     1 B     A         3
## 6     1 B     B         0</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="plotting-sociomatrices-1.html#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(df)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   Group id1   id2   value
##   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;
## 1     3 C     C         0
## 2     3 C     D         7
## 3     3 D     A         2
## 4     3 D     B         4
## 5     3 D     C         4
## 6     3 D     D         0</code></pre>
<p><br></p>
<p>We can look at the win-loss matrices from each of these three groups:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="plotting-sociomatrices-1.html#cb151-1" aria-hidden="true" tabindex="-1"></a>mats <span class="ot">&lt;-</span> <span class="fu">split</span>(df, df<span class="sc">$</span>Group) <span class="sc">%&gt;%</span></span>
<span id="cb151-2"><a href="plotting-sociomatrices-1.html#cb151-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span> reshape2<span class="sc">::</span><span class="fu">acast</span>(., id1<span class="sc">~</span>id2, <span class="at">value.var=</span><span class="st">&quot;value&quot;</span>))</span>
<span id="cb151-3"><a href="plotting-sociomatrices-1.html#cb151-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-4"><a href="plotting-sociomatrices-1.html#cb151-4" aria-hidden="true" tabindex="-1"></a>mats</span></code></pre></div>
<pre><code>## $`1`
##   A  B  C D
## A 0 15 11 8
## B 3  0  4 2
## C 0  0  0 1
## D 0  0  0 0
## 
## $`2`
##   A B C D
## A 0 0 0 1
## B 2 0 1 1
## C 4 6 0 3
## D 4 5 2 0
## 
## $`3`
##    A B  C D
## A  0 3  0 5
## B 33 0 24 7
## C 11 3  0 7
## D  2 4  4 0</code></pre>
<p><br></p>
<p>One approach would be to create three separate matrices and plot them side by side. Let’s first create a plotting function that will color the tiles by the number of wins in each matrix. Then we’ll apply that function to each of the three groups separately.</p>
<p>Here is the function:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="plotting-sociomatrices-1.html#cb153-1" aria-hidden="true" tabindex="-1"></a>make_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(mat){</span>
<span id="cb153-2"><a href="plotting-sociomatrices-1.html#cb153-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-3"><a href="plotting-sociomatrices-1.html#cb153-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Although plotting by value, adding in code that would enable filling by DC  </span></span>
<span id="cb153-4"><a href="plotting-sociomatrices-1.html#cb153-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb153-5"><a href="plotting-sociomatrices-1.html#cb153-5" aria-hidden="true" tabindex="-1"></a><span class="co"># melt matrix back to df</span></span>
<span id="cb153-6"><a href="plotting-sociomatrices-1.html#cb153-6" aria-hidden="true" tabindex="-1"></a>m.dat <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(mat)</span>
<span id="cb153-7"><a href="plotting-sociomatrices-1.html#cb153-7" aria-hidden="true" tabindex="-1"></a>m.dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(m.dat)</span>
<span id="cb153-8"><a href="plotting-sociomatrices-1.html#cb153-8" aria-hidden="true" tabindex="-1"></a>m.dat <span class="ot">&lt;-</span> m.dat[<span class="fu">complete.cases</span>(m.dat),] <span class="co">#removing NAs</span></span>
<span id="cb153-9"><a href="plotting-sociomatrices-1.html#cb153-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-10"><a href="plotting-sociomatrices-1.html#cb153-10" aria-hidden="true" tabindex="-1"></a><span class="co"># remove 0s from value column</span></span>
<span id="cb153-11"><a href="plotting-sociomatrices-1.html#cb153-11" aria-hidden="true" tabindex="-1"></a>m.dat<span class="sc">$</span>value <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(m.dat<span class="sc">$</span>value<span class="sc">==</span><span class="dv">0</span>, <span class="cn">NA</span>, m.dat<span class="sc">$</span>value)</span>
<span id="cb153-12"><a href="plotting-sociomatrices-1.html#cb153-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-13"><a href="plotting-sociomatrices-1.html#cb153-13" aria-hidden="true" tabindex="-1"></a><span class="co"># factorize ids by rank order </span></span>
<span id="cb153-14"><a href="plotting-sociomatrices-1.html#cb153-14" aria-hidden="true" tabindex="-1"></a>isi <span class="ot">&lt;-</span> <span class="fu">isi98</span>(mat)</span>
<span id="cb153-15"><a href="plotting-sociomatrices-1.html#cb153-15" aria-hidden="true" tabindex="-1"></a>m.dat<span class="sc">$</span>Var2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(m.dat<span class="sc">$</span>Var2, <span class="at">levels=</span>isi<span class="sc">$</span>best_order)</span>
<span id="cb153-16"><a href="plotting-sociomatrices-1.html#cb153-16" aria-hidden="true" tabindex="-1"></a>m.dat<span class="sc">$</span>Var1 <span class="ot">&lt;-</span> <span class="fu">factor</span>(m.dat<span class="sc">$</span>Var1, <span class="at">levels =</span> <span class="fu">rev</span>(isi<span class="sc">$</span>best_order))</span>
<span id="cb153-17"><a href="plotting-sociomatrices-1.html#cb153-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-18"><a href="plotting-sociomatrices-1.html#cb153-18" aria-hidden="true" tabindex="-1"></a><span class="co"># create directional consistency column</span></span>
<span id="cb153-19"><a href="plotting-sociomatrices-1.html#cb153-19" aria-hidden="true" tabindex="-1"></a>dcs <span class="ot">&lt;-</span> mat <span class="sc">/</span> (mat <span class="sc">+</span> <span class="fu">t</span>(mat))</span>
<span id="cb153-20"><a href="plotting-sociomatrices-1.html#cb153-20" aria-hidden="true" tabindex="-1"></a>m.dat<span class="sc">$</span>DC <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(dcs)[,<span class="dv">3</span>]</span>
<span id="cb153-21"><a href="plotting-sociomatrices-1.html#cb153-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-22"><a href="plotting-sociomatrices-1.html#cb153-22" aria-hidden="true" tabindex="-1"></a><span class="co"># create directional consistency column only &gt;0.5</span></span>
<span id="cb153-23"><a href="plotting-sociomatrices-1.html#cb153-23" aria-hidden="true" tabindex="-1"></a>dcs[dcs<span class="sc">&lt;=</span><span class="fu">t</span>(dcs)]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb153-24"><a href="plotting-sociomatrices-1.html#cb153-24" aria-hidden="true" tabindex="-1"></a>m.dat<span class="sc">$</span>DC1 <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(dcs)[,<span class="dv">3</span>]</span>
<span id="cb153-25"><a href="plotting-sociomatrices-1.html#cb153-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-26"><a href="plotting-sociomatrices-1.html#cb153-26" aria-hidden="true" tabindex="-1"></a><span class="co"># put in .5 as minimum DC column</span></span>
<span id="cb153-27"><a href="plotting-sociomatrices-1.html#cb153-27" aria-hidden="true" tabindex="-1"></a>m.dat<span class="sc">$</span>DC1 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(m.dat<span class="sc">$</span>DC1), .<span class="dv">5</span>, m.dat<span class="sc">$</span>DC1)</span>
<span id="cb153-28"><a href="plotting-sociomatrices-1.html#cb153-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-29"><a href="plotting-sociomatrices-1.html#cb153-29" aria-hidden="true" tabindex="-1"></a><span class="co"># put in 0 as minimum in value1 column for fill</span></span>
<span id="cb153-30"><a href="plotting-sociomatrices-1.html#cb153-30" aria-hidden="true" tabindex="-1"></a>m.dat<span class="sc">$</span>value1 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(m.dat<span class="sc">$</span>value), .<span class="dv">5</span>, m.dat<span class="sc">$</span>value)</span>
<span id="cb153-31"><a href="plotting-sociomatrices-1.html#cb153-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-32"><a href="plotting-sociomatrices-1.html#cb153-32" aria-hidden="true" tabindex="-1"></a><span class="co"># plot  </span></span>
<span id="cb153-33"><a href="plotting-sociomatrices-1.html#cb153-33" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(m.dat, <span class="fu">aes</span>(<span class="at">x=</span>Var2, <span class="at">y=</span>Var1, <span class="at">fill=</span>value1)) <span class="sc">+</span></span>
<span id="cb153-34"><a href="plotting-sociomatrices-1.html#cb153-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb153-35"><a href="plotting-sociomatrices-1.html#cb153-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> value), <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fu">rel</span>(<span class="fl">3.5</span>)) <span class="sc">+</span></span>
<span id="cb153-36"><a href="plotting-sociomatrices-1.html#cb153-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb153-37"><a href="plotting-sociomatrices-1.html#cb153-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">position =</span> <span class="st">&quot;top&quot;</span>) <span class="sc">+</span></span>
<span id="cb153-38"><a href="plotting-sociomatrices-1.html#cb153-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb153-39"><a href="plotting-sociomatrices-1.html#cb153-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Loser&quot;</span>) <span class="sc">+</span> </span>
<span id="cb153-40"><a href="plotting-sociomatrices-1.html#cb153-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Winner&quot;</span>) <span class="sc">+</span> </span>
<span id="cb153-41"><a href="plotting-sociomatrices-1.html#cb153-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb153-42"><a href="plotting-sociomatrices-1.html#cb153-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb153-43"><a href="plotting-sociomatrices-1.html#cb153-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb153-44"><a href="plotting-sociomatrices-1.html#cb153-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb153-45"><a href="plotting-sociomatrices-1.html#cb153-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>,<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">linetype=</span><span class="st">&quot;solid&quot;</span>),</span>
<span id="cb153-46"><a href="plotting-sociomatrices-1.html#cb153-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb153-47"><a href="plotting-sociomatrices-1.html#cb153-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb153-48"><a href="plotting-sociomatrices-1.html#cb153-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb153-49"><a href="plotting-sociomatrices-1.html#cb153-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb153-50"><a href="plotting-sociomatrices-1.html#cb153-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;#3C3C3C&quot;</span>, <span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.1</span>)),</span>
<span id="cb153-51"><a href="plotting-sociomatrices-1.html#cb153-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>        </span>
<span id="cb153-52"><a href="plotting-sociomatrices-1.html#cb153-52" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb153-53"><a href="plotting-sociomatrices-1.html#cb153-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(</span>
<span id="cb153-54"><a href="plotting-sociomatrices-1.html#cb153-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">low =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb153-55"><a href="plotting-sociomatrices-1.html#cb153-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">high =</span> <span class="st">&quot;red1&quot;</span>, </span>
<span id="cb153-56"><a href="plotting-sociomatrices-1.html#cb153-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">space =</span> <span class="st">&quot;Lab&quot;</span>, </span>
<span id="cb153-57"><a href="plotting-sociomatrices-1.html#cb153-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb153-58"><a href="plotting-sociomatrices-1.html#cb153-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">guide =</span> <span class="st">&quot;colourbar&quot;</span>)</span>
<span id="cb153-59"><a href="plotting-sociomatrices-1.html#cb153-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-60"><a href="plotting-sociomatrices-1.html#cb153-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb153-61"><a href="plotting-sociomatrices-1.html#cb153-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb153-62"><a href="plotting-sociomatrices-1.html#cb153-62" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(p)</span>
<span id="cb153-63"><a href="plotting-sociomatrices-1.html#cb153-63" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><br></p>
<p>Now we will create individual plots and put them together using <code>gridExtra</code>.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="plotting-sociomatrices-1.html#cb154-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">make_plot</span>(mats[[<span class="dv">1</span>]])</span>
<span id="cb154-2"><a href="plotting-sociomatrices-1.html#cb154-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">make_plot</span>(mats[[<span class="dv">2</span>]])</span>
<span id="cb154-3"><a href="plotting-sociomatrices-1.html#cb154-3" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">make_plot</span>(mats[[<span class="dv">3</span>]])</span></code></pre></div>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="plotting-sociomatrices-1.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb155-2"><a href="plotting-sociomatrices-1.html#cb155-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-3"><a href="plotting-sociomatrices-1.html#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1,p2,p3, <span class="at">nrow=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-178-1.png" width="864" /></p>
<p><br></p>
<p>Hopefully you notice what the problem is with this approach. The highest value in each matrix(15, 6, 33) is the same shade of red which is misleading.</p>
<p>What we have to do instead is scale the fill color based on the whole range of values across all matrices.</p>
<p>The best way to do this is to have all of the data in one dataframe and create a scale based on the value column. We can do that as follows:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="plotting-sociomatrices-1.html#cb156-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>scale_value <span class="ot">&lt;-</span> (df<span class="sc">$</span>value<span class="sc">-</span><span class="fu">min</span>(df<span class="sc">$</span>value)) <span class="sc">/</span> ((<span class="fu">max</span>(df<span class="sc">$</span>value)<span class="sc">-</span><span class="fu">min</span>(df<span class="sc">$</span>value)))</span>
<span id="cb156-2"><a href="plotting-sociomatrices-1.html#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   Group id1   id2   value scale_value
##   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;       &lt;dbl&gt;
## 1     1 A     A         0      0     
## 2     1 A     B        15      0.455 
## 3     1 A     C        11      0.333 
## 4     1 A     D         8      0.242 
## 5     1 B     A         3      0.0909
## 6     1 B     B         0      0</code></pre>
<p><br></p>
<p>We next have to piece that scale_value back. The best way to do this is to start right back from the original data.frame including all groups. But before we do that, let’s create all the data.frames we need for plotting and store them in a list:</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="plotting-sociomatrices-1.html#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get matrices</span></span>
<span id="cb158-2"><a href="plotting-sociomatrices-1.html#cb158-2" aria-hidden="true" tabindex="-1"></a>mats <span class="ot">&lt;-</span> <span class="fu">split</span>(df, df<span class="sc">$</span>Group) <span class="sc">%&gt;%</span></span>
<span id="cb158-3"><a href="plotting-sociomatrices-1.html#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span> reshape2<span class="sc">::</span><span class="fu">acast</span>(., id1<span class="sc">~</span>id2, <span class="at">value.var=</span><span class="st">&quot;value&quot;</span>))</span>
<span id="cb158-4"><a href="plotting-sociomatrices-1.html#cb158-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-5"><a href="plotting-sociomatrices-1.html#cb158-5" aria-hidden="true" tabindex="-1"></a><span class="co"># make dataframe for plotting</span></span>
<span id="cb158-6"><a href="plotting-sociomatrices-1.html#cb158-6" aria-hidden="true" tabindex="-1"></a>dx <span class="ot">&lt;-</span> mats <span class="sc">%&gt;%</span></span>
<span id="cb158-7"><a href="plotting-sociomatrices-1.html#cb158-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb158-8"><a href="plotting-sociomatrices-1.html#cb158-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span> <span class="fu">data.frame</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb158-9"><a href="plotting-sociomatrices-1.html#cb158-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span> <span class="fu">mutate</span>(., <span class="at">value0 =</span> <span class="fu">ifelse</span>(value<span class="sc">==</span><span class="dv">0</span>, <span class="cn">NA</span>, value)))</span>
<span id="cb158-10"><a href="plotting-sociomatrices-1.html#cb158-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-11"><a href="plotting-sociomatrices-1.html#cb158-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-12"><a href="plotting-sociomatrices-1.html#cb158-12" aria-hidden="true" tabindex="-1"></a><span class="co"># get rank orders</span></span>
<span id="cb158-13"><a href="plotting-sociomatrices-1.html#cb158-13" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fu">lapply</span>(mats, isi98) <span class="sc">%&gt;%</span> <span class="fu">map</span>(<span class="sc">~</span> .<span class="sc">$</span>best_order)</span></code></pre></div>
<p><br></p>
<p>We can look at these like this:</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="plotting-sociomatrices-1.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(dx, head)</span></code></pre></div>
<pre><code>## $`1`
##   Var1 Var2 value value0
## 1    A    A     0     NA
## 2    B    A     3      3
## 3    C    A     0     NA
## 4    D    A     0     NA
## 5    A    B    15     15
## 6    B    B     0     NA
## 
## $`2`
##   Var1 Var2 value value0
## 1    A    A     0     NA
## 2    B    A     2      2
## 3    C    A     4      4
## 4    D    A     4      4
## 5    A    B     0     NA
## 6    B    B     0     NA
## 
## $`3`
##   Var1 Var2 value value0
## 1    A    A     0     NA
## 2    B    A    33     33
## 3    C    A    11     11
## 4    D    A     2      2
## 5    A    B     3      3
## 6    B    B     0     NA</code></pre>
<p><br></p>
<p>Next we need to add the scale column. Again, we can do this to each element of the list using a loop:</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="plotting-sociomatrices-1.html#cb161-1" aria-hidden="true" tabindex="-1"></a>df.l <span class="ot">&lt;-</span> <span class="fu">split</span>(df, df<span class="sc">$</span>Group)</span>
<span id="cb161-2"><a href="plotting-sociomatrices-1.html#cb161-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-3"><a href="plotting-sociomatrices-1.html#cb161-3" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb161-4"><a href="plotting-sociomatrices-1.html#cb161-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(l)){</span>
<span id="cb161-5"><a href="plotting-sociomatrices-1.html#cb161-5" aria-hidden="true" tabindex="-1"></a>df.l[[i]]<span class="sc">$</span>Var1 <span class="ot">&lt;-</span> df.l[[i]]<span class="sc">$</span>id1</span>
<span id="cb161-6"><a href="plotting-sociomatrices-1.html#cb161-6" aria-hidden="true" tabindex="-1"></a>df.l[[i]]<span class="sc">$</span>Var2 <span class="ot">&lt;-</span> df.l[[i]]<span class="sc">$</span>id2</span>
<span id="cb161-7"><a href="plotting-sociomatrices-1.html#cb161-7" aria-hidden="true" tabindex="-1"></a>out[[i]] <span class="ot">&lt;-</span> <span class="fu">full_join</span>(dx[[i]],df.l[[i]])  </span>
<span id="cb161-8"><a href="plotting-sociomatrices-1.html#cb161-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-9"><a href="plotting-sociomatrices-1.html#cb161-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-10"><a href="plotting-sociomatrices-1.html#cb161-10" aria-hidden="true" tabindex="-1"></a><span class="co"># factorize</span></span>
<span id="cb161-11"><a href="plotting-sociomatrices-1.html#cb161-11" aria-hidden="true" tabindex="-1"></a>  out[[i]]<span class="sc">$</span>Var2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(out[[i]]<span class="sc">$</span>Var2, <span class="at">levels=</span>l[[i]])</span>
<span id="cb161-12"><a href="plotting-sociomatrices-1.html#cb161-12" aria-hidden="true" tabindex="-1"></a>  out[[i]]<span class="sc">$</span>Var1 <span class="ot">&lt;-</span> <span class="fu">factor</span>(out[[i]]<span class="sc">$</span>Var1, <span class="at">levels =</span> <span class="fu">rev</span>(l[[i]]))</span>
<span id="cb161-13"><a href="plotting-sociomatrices-1.html#cb161-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb161-14"><a href="plotting-sociomatrices-1.html#cb161-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-15"><a href="plotting-sociomatrices-1.html#cb161-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-16"><a href="plotting-sociomatrices-1.html#cb161-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-17"><a href="plotting-sociomatrices-1.html#cb161-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-18"><a href="plotting-sociomatrices-1.html#cb161-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-19"><a href="plotting-sociomatrices-1.html#cb161-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-20"><a href="plotting-sociomatrices-1.html#cb161-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(out,head)</span></code></pre></div>
<pre><code>## [[1]]
##   Var1 Var2 value value0 Group id1 id2 scale_value
## 1    A    A     0     NA     1   A   A  0.00000000
## 2    B    A     3      3     1   B   A  0.09090909
## 3    C    A     0     NA     1   C   A  0.00000000
## 4    D    A     0     NA     1   D   A  0.00000000
## 5    A    B    15     15     1   A   B  0.45454545
## 6    B    B     0     NA     1   B   B  0.00000000
## 
## [[2]]
##   Var1 Var2 value value0 Group id1 id2 scale_value
## 1    A    A     0     NA     2   A   A  0.00000000
## 2    B    A     2      2     2   B   A  0.06060606
## 3    C    A     4      4     2   C   A  0.12121212
## 4    D    A     4      4     2   D   A  0.12121212
## 5    A    B     0     NA     2   A   B  0.00000000
## 6    B    B     0     NA     2   B   B  0.00000000
## 
## [[3]]
##   Var1 Var2 value value0 Group id1 id2 scale_value
## 1    A    A     0     NA     3   A   A  0.00000000
## 2    B    A    33     33     3   B   A  1.00000000
## 3    C    A    11     11     3   C   A  0.33333333
## 4    D    A     2      2     3   D   A  0.06060606
## 5    A    B     3      3     3   A   B  0.09090909
## 6    B    B     0     NA     3   B   B  0.00000000</code></pre>
<p><br></p>
<p>We can very nearly do the plotting. However, there is still one thing to fix. Previously, the <code>scale_fill_manual()</code> worked by setting a range between two colors based on the values in a particular column. This time, we want the fill to be based on the <code>scale_value</code> column which ranges from 0 to 1 across the data but may range between any values in between for any given data.frame. Therefore, we need to scale the fill slightly differently.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="plotting-sociomatrices-1.html#cb163-1" aria-hidden="true" tabindex="-1"></a>make_scale_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(df){</span>
<span id="cb163-2"><a href="plotting-sociomatrices-1.html#cb163-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Var2, <span class="at">y=</span>Var1, <span class="at">fill=</span>scale_value)) <span class="sc">+</span></span>
<span id="cb163-3"><a href="plotting-sociomatrices-1.html#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb163-4"><a href="plotting-sociomatrices-1.html#cb163-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> value0), <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fu">rel</span>(<span class="fl">3.5</span>)) <span class="sc">+</span></span>
<span id="cb163-5"><a href="plotting-sociomatrices-1.html#cb163-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb163-6"><a href="plotting-sociomatrices-1.html#cb163-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">position =</span> <span class="st">&quot;top&quot;</span>) <span class="sc">+</span></span>
<span id="cb163-7"><a href="plotting-sociomatrices-1.html#cb163-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb163-8"><a href="plotting-sociomatrices-1.html#cb163-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Loser&quot;</span>) <span class="sc">+</span> </span>
<span id="cb163-9"><a href="plotting-sociomatrices-1.html#cb163-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Winner&quot;</span>) <span class="sc">+</span> </span>
<span id="cb163-10"><a href="plotting-sociomatrices-1.html#cb163-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb163-11"><a href="plotting-sociomatrices-1.html#cb163-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb163-12"><a href="plotting-sociomatrices-1.html#cb163-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb163-13"><a href="plotting-sociomatrices-1.html#cb163-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb163-14"><a href="plotting-sociomatrices-1.html#cb163-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>,<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">linetype=</span><span class="st">&quot;solid&quot;</span>),</span>
<span id="cb163-15"><a href="plotting-sociomatrices-1.html#cb163-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb163-16"><a href="plotting-sociomatrices-1.html#cb163-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb163-17"><a href="plotting-sociomatrices-1.html#cb163-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb163-18"><a href="plotting-sociomatrices-1.html#cb163-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb163-19"><a href="plotting-sociomatrices-1.html#cb163-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;#3C3C3C&quot;</span>, <span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.1</span>)),</span>
<span id="cb163-20"><a href="plotting-sociomatrices-1.html#cb163-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>        </span>
<span id="cb163-21"><a href="plotting-sociomatrices-1.html#cb163-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb163-22"><a href="plotting-sociomatrices-1.html#cb163-22" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_fill_gradientn</span>(</span>
<span id="cb163-23"><a href="plotting-sociomatrices-1.html#cb163-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb163-24"><a href="plotting-sociomatrices-1.html#cb163-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">colors=</span><span class="fu">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;red1&quot;</span>)</span>
<span id="cb163-25"><a href="plotting-sociomatrices-1.html#cb163-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb163-26"><a href="plotting-sociomatrices-1.html#cb163-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb163-27"><a href="plotting-sociomatrices-1.html#cb163-27" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(p)</span>
<span id="cb163-28"><a href="plotting-sociomatrices-1.html#cb163-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-29"><a href="plotting-sociomatrices-1.html#cb163-29" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><br></p>
<p>We can finally plot each matrix side-by-side:</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="plotting-sociomatrices-1.html#cb164-1" aria-hidden="true" tabindex="-1"></a>pp1 <span class="ot">&lt;-</span> <span class="fu">make_scale_plot</span>(out[[<span class="dv">1</span>]])</span>
<span id="cb164-2"><a href="plotting-sociomatrices-1.html#cb164-2" aria-hidden="true" tabindex="-1"></a>pp2 <span class="ot">&lt;-</span> <span class="fu">make_scale_plot</span>(out[[<span class="dv">2</span>]])</span>
<span id="cb164-3"><a href="plotting-sociomatrices-1.html#cb164-3" aria-hidden="true" tabindex="-1"></a>pp3 <span class="ot">&lt;-</span> <span class="fu">make_scale_plot</span>(out[[<span class="dv">3</span>]])</span></code></pre></div>
<p><br></p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="plotting-sociomatrices-1.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(pp1,pp2,pp3, <span class="at">nrow=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-185-1.png" width="864" /></p>
<p><br></p>
<p>There are clearly many improvements that could be made. The code could definitely be cleaned up for the multiple sociomatrices. We also probably don’t want to have “Winner” and “Loser” labels on every matrix. There are probably other things we could do better too.</p>
<p><br></p>
<p><br></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="analyzing-social-hierarchy-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="social-networks.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jalapic/guides/edit/master/03-sociomatix.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/jalapic/guides/blob/master/03-sociomatix.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
